2025-05-12 20:51:04,744 - root - INFO - 配置: {'EXPERIMENT_DIR': 'output\\20250512_205054', 'OUTPUT_DIR': './output', 'DATA_DIR': './datasets', 'BATCH_SIZE': 8, 'NUM_EPOCHS': 1, 'LEARNING_RATE': 0.0001, 'DEVICE': 'cuda'}
2025-05-12 20:51:05,936 - root - INFO - 使用设备: cuda
2025-05-12 20:51:05,937 - root - INFO - 加载RNA-FM模型...
2025-05-12 20:51:07,738 - root - INFO - RNA-FM模型加载完成
2025-05-12 20:51:07,739 - root - INFO - 创建数据集，从目录: ./datasets
2025-05-12 20:51:07,739 - data.dataset - INFO - 找到1个pkl文件
2025-05-12 20:51:07,740 - data.dataset - INFO - 从缓存加载数据: ./output\cache\processed_data.pt
2025-05-12 20:51:07,911 - data.dataset - INFO - 从缓存加载了 161 个样本
2025-05-12 20:51:07,911 - data.dataset - INFO - 成功加载161个RNA样本
2025-05-12 20:51:07,912 - root - INFO - 创建数据加载器...
2025-05-12 20:51:07,912 - data.dataset - INFO - 数据集大小: 161
2025-05-12 20:51:07,912 - data.dataset - INFO - 数据集划分: 训练集=128, 验证集=16, 测试集=17
2025-05-12 20:51:07,913 - root - INFO - 创建扭转角预测模型...
2025-05-12 20:51:07,913 - models.torsion_predictor - INFO - 使用提供的RNA-FM模型
2025-05-12 20:51:07,914 - models.torsion_predictor - INFO - RNA-FM参数已冻结
2025-05-12 20:51:07,941 - root - INFO - 开始训练，共1个epoch
2025-05-12 20:52:03,731 - root - INFO - Epoch 1/1, Batch 10/16, Loss: 11.6348
2025-05-12 20:52:05,608 - root - INFO - Epoch 1/1 训练完成，耗时: 57.67秒, 平均损失: 12.3787
2025-05-12 20:53:02,128 - root - INFO - Epoch 1/1 验证完成，平均损失: 8.0265
2025-05-12 20:53:02,135 - models.torsion_predictor - INFO - 模型已保存到 output\20250512_205054\checkpoints\best_model.pth
2025-05-12 20:53:02,136 - root - INFO - 最佳模型已保存，验证损失: 8.0265
2025-05-12 20:53:02,136 - root - INFO - 训练完成
2025-05-12 20:53:02,136 - root - INFO - 加载最佳模型并在测试集上评估...
2025-05-12 20:53:02,143 - models.torsion_predictor - INFO - 从 output\20250512_205054\checkpoints\best_model.pth 加载了模型
2025-05-12 20:53:02,143 - models.torsion_predictor - INFO - 加载了扭转角类型: ['alpha', 'beta', 'gamma', 'delta', 'epsilon', 'zeta', 'chi', 'eta', 'theta', "eta'", "theta'", 'v0', 'v1', 'v2', 'v3', 'v4']
2025-05-12 20:53:02,143 - root - INFO - 测试结果将保存到: output\20250512_205054\test_results
2025-05-12 20:53:57,494 - utils.evaluation - INFO - 开始计算各角度评估指标
2025-05-12 20:53:57,500 - utils.evaluation - INFO - alpha MAE: 45.4755, 相关性: 0.2790
2025-05-12 20:53:57,502 - utils.evaluation - INFO - beta MAE: 22.3576, 相关性: 0.3931
2025-05-12 20:53:57,505 - utils.evaluation - INFO - delta MAE: 15.5604, 相关性: 0.4373
2025-05-12 20:53:57,507 - utils.evaluation - INFO - epsilon MAE: 28.2183, 相关性: 0.3815
2025-05-12 20:53:57,511 - utils.evaluation - INFO - gamma MAE: 38.0909, 相关性: 0.2891
2025-05-12 20:53:57,514 - utils.evaluation - INFO - zeta MAE: 28.0754, 相关性: 0.3539
2025-05-12 20:53:57,519 - utils.evaluation - INFO - chi MAE: 28.4437, 相关性: 0.3794
2025-05-12 20:53:57,521 - utils.evaluation - INFO - eta MAE: 31.9991, 相关性: 0.3560
2025-05-12 20:53:57,524 - utils.evaluation - INFO - eta' MAE: 23.0723, 相关性: 0.3911
2025-05-12 20:53:57,526 - utils.evaluation - INFO - theta MAE: 31.7724, 相关性: 0.3381
2025-05-12 20:53:57,528 - utils.evaluation - INFO - theta' MAE: 29.2323, 相关性: 0.3550
2025-05-12 20:53:57,530 - utils.evaluation - INFO - v0 MAE: 15.2985, 相关性: 0.4430
2025-05-12 20:53:57,533 - utils.evaluation - INFO - v1 MAE: 17.9920, 相关性: 0.4178
2025-05-12 20:53:57,535 - utils.evaluation - INFO - v2 MAE: 22.3049, 相关性: 0.4188
2025-05-12 20:53:57,537 - utils.evaluation - INFO - v3 MAE: 12.4153, 相关性: 0.4384
2025-05-12 20:53:57,539 - utils.evaluation - INFO - v4 MAE: 10.1225, 相关性: 0.4556
2025-05-12 20:53:57,540 - utils.evaluation - INFO - ==== 按组评估结果 ====
2025-05-12 20:53:57,540 - utils.evaluation - INFO - backbone 平均MAE: 29.63°, 平均相关性: 0.3556464635858348
2025-05-12 20:53:57,540 - utils.evaluation - INFO - chi 平均MAE: 28.44°, 平均相关性: 0.37936901695588054
2025-05-12 20:53:57,540 - utils.evaluation - INFO - pseudo 平均MAE: 29.02°, 平均相关性: 0.36004381780238714
2025-05-12 20:53:57,541 - utils.evaluation - INFO - ribose 平均MAE: 15.63°, 平均相关性: 0.4347382899592905
2025-05-12 20:53:57,541 - utils.evaluation - INFO - 总体平均 MAE: 25.03°
2025-05-12 20:53:58,075 - utils.evaluation - INFO - 评估完成，总计指标项: 41项
2025-05-12 20:53:58,076 - root - INFO - 评估完成，指标:
2025-05-12 20:53:58,076 - root - INFO - alpha_mae: 45.4755
2025-05-12 20:53:58,077 - root - INFO - alpha_corr: 0.2790
2025-05-12 20:53:58,077 - root - INFO - beta_mae: 22.3576
2025-05-12 20:53:58,077 - root - INFO - beta_corr: 0.3931
2025-05-12 20:53:58,077 - root - INFO - delta_mae: 15.5604
2025-05-12 20:53:58,077 - root - INFO - delta_corr: 0.4373
2025-05-12 20:53:58,077 - root - INFO - epsilon_mae: 28.2183
2025-05-12 20:53:58,078 - root - INFO - epsilon_corr: 0.3815
2025-05-12 20:53:58,078 - root - INFO - gamma_mae: 38.0909
2025-05-12 20:53:58,078 - root - INFO - gamma_corr: 0.2891
2025-05-12 20:53:58,078 - root - INFO - zeta_mae: 28.0754
2025-05-12 20:53:58,078 - root - INFO - zeta_corr: 0.3539
2025-05-12 20:53:58,078 - root - INFO - chi_mae: 28.4437
2025-05-12 20:53:58,078 - root - INFO - chi_corr: 0.3794
2025-05-12 20:53:58,078 - root - INFO - eta_mae: 31.9991
2025-05-12 20:53:58,078 - root - INFO - eta_corr: 0.3560
2025-05-12 20:53:58,078 - root - INFO - eta'_mae: 23.0723
2025-05-12 20:53:58,078 - root - INFO - eta'_corr: 0.3911
2025-05-12 20:53:58,078 - root - INFO - theta_mae: 31.7724
2025-05-12 20:53:58,079 - root - INFO - theta_corr: 0.3381
2025-05-12 20:53:58,079 - root - INFO - theta'_mae: 29.2323
2025-05-12 20:53:58,079 - root - INFO - theta'_corr: 0.3550
2025-05-12 20:53:58,079 - root - INFO - v0_mae: 15.2985
2025-05-12 20:53:58,079 - root - INFO - v0_corr: 0.4430
2025-05-12 20:53:58,079 - root - INFO - v1_mae: 17.9920
2025-05-12 20:53:58,079 - root - INFO - v1_corr: 0.4178
2025-05-12 20:53:58,079 - root - INFO - v2_mae: 22.3049
2025-05-12 20:53:58,079 - root - INFO - v2_corr: 0.4188
2025-05-12 20:53:58,079 - root - INFO - v3_mae: 12.4153
2025-05-12 20:53:58,079 - root - INFO - v3_corr: 0.4384
2025-05-12 20:53:58,079 - root - INFO - v4_mae: 10.1225
2025-05-12 20:53:58,079 - root - INFO - v4_corr: 0.4556
2025-05-12 20:53:58,080 - root - INFO - backbone_avg_mae: 29.6297
2025-05-12 20:53:58,080 - root - INFO - backbone_avg_corr: 0.3556
2025-05-12 20:53:58,080 - root - INFO - chi_avg_mae: 28.4437
2025-05-12 20:53:58,080 - root - INFO - chi_avg_corr: 0.3794
2025-05-12 20:53:58,080 - root - INFO - pseudo_avg_mae: 29.0190
2025-05-12 20:53:58,080 - root - INFO - pseudo_avg_corr: 0.3600
2025-05-12 20:53:58,080 - root - INFO - ribose_avg_mae: 15.6267
2025-05-12 20:53:58,080 - root - INFO - ribose_avg_corr: 0.4347
2025-05-12 20:53:58,080 - root - INFO - avg_mae: 25.0270
