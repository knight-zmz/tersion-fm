2025-05-12 19:41:57,269 - root - INFO - 配置: {'EXPERIMENT_DIR': 'output\\20250512_194147', 'OUTPUT_DIR': './output', 'DATA_DIR': './datasets', 'BATCH_SIZE': 8, 'NUM_EPOCHS': 1, 'LEARNING_RATE': 0.0001, 'DEVICE': 'cuda'}
2025-05-12 19:41:58,465 - root - INFO - 使用设备: cuda
2025-05-12 19:41:58,466 - root - INFO - 加载RNA-FM模型...
2025-05-12 19:42:00,612 - root - INFO - RNA-FM模型加载完成
2025-05-12 19:42:00,613 - root - INFO - 创建数据集，从目录: ./datasets
2025-05-12 19:42:00,614 - data.dataset - INFO - 找到1个pkl文件
2025-05-12 19:42:00,615 - data.dataset - INFO - 找到 1 个数据文件
2025-05-12 19:42:00,979 - data.dataset - INFO - 检测到训练字典格式: Training_Dict_single.pkl
2025-05-12 19:42:01,051 - data.adapters - INFO - 跳过多链RNA: 1hmh
2025-05-12 19:42:01,057 - data.adapters - INFO - 跳过多链RNA: 1mme
2025-05-12 19:42:01,083 - data.adapters - INFO - 跳过多链RNA: 1biv
2025-05-12 19:42:01,110 - data.adapters - INFO - 跳过多链RNA: 1etf
2025-05-12 19:42:01,144 - data.adapters - INFO - 跳过多链RNA: 1zdi
2025-05-12 19:42:01,183 - data.adapters - INFO - 跳过多链RNA: 1ull
2025-05-12 19:42:01,183 - data.adapters - INFO - 跳过多链RNA: 1kis
2025-05-12 19:42:01,184 - data.adapters - INFO - 跳过多链RNA: 1kis
2025-05-12 19:42:01,262 - data.adapters - INFO - 跳过多链RNA: 1aud
2025-05-12 19:42:01,273 - data.adapters - INFO - 跳过多链RNA: 1a4t
2025-05-12 19:42:01,336 - data.adapters - INFO - 跳过多链RNA: 1a1t
2025-05-12 19:42:01,336 - data.adapters - INFO - 跳过多链RNA: 1a9n
2025-05-12 19:42:01,366 - data.adapters - INFO - 跳过多链RNA: 7msf
2025-05-12 19:42:01,367 - data.adapters - INFO - 跳过多链RNA: 5msf
2025-05-12 19:42:01,382 - data.adapters - INFO - 跳过多链RNA: 1zdk
2025-05-12 19:42:01,417 - data.adapters - INFO - 跳过多链RNA: 1hvu
2025-05-12 19:42:01,430 - data.adapters - INFO - 跳过多链RNA: 2bj2
2025-05-12 19:42:01,430 - data.adapters - INFO - 跳过多链RNA: 2bj2
2025-05-12 19:42:01,446 - data.adapters - INFO - 跳过多链RNA: 1qfq
2025-05-12 19:42:01,459 - data.adapters - INFO - 跳过多链RNA: 1bau
2025-05-12 19:42:01,508 - data.adapters - INFO - 跳过多链RNA: 484d
2025-05-12 19:42:01,509 - data.adapters - INFO - 跳过多链RNA: 1d6k
2025-05-12 19:42:01,509 - data.adapters - INFO - 跳过多链RNA: 1eiy
2025-05-12 19:42:01,516 - data.adapters - INFO - 跳过多链RNA: 1exy
2025-05-12 19:42:01,540 - data.adapters - INFO - 跳过多链RNA: 1euq
2025-05-12 19:42:01,553 - data.adapters - INFO - 跳过多链RNA: 1ffk
2025-05-12 19:42:01,553 - data.adapters - INFO - 跳过多链RNA: 1ekz
2025-05-12 19:42:01,553 - data.adapters - INFO - 跳过多链RNA: 1f5u
2025-05-12 19:42:01,603 - data.adapters - INFO - 跳过多链RNA: 1foq
2025-05-12 19:42:01,603 - data.adapters - INFO - 跳过多链RNA: 1fje
2025-05-12 19:42:01,630 - data.adapters - INFO - 跳过多链RNA: 1g70
2025-05-12 19:42:01,631 - data.adapters - INFO - 跳过多链RNA: 1e7k
2025-05-12 19:42:01,675 - data.adapters - INFO - 跳过多链RNA: 1ibm
2025-05-12 19:42:01,753 - data.adapters - INFO - 跳过多链RNA: 1k9w
2025-05-12 19:42:01,834 - data.adapters - INFO - 跳过多链RNA: 1l1c
2025-05-12 19:42:01,895 - data.adapters - INFO - 跳过多链RNA: 1ls2
2025-05-12 19:42:01,960 - data.adapters - INFO - 跳过多链RNA: 1n34
2025-05-12 19:42:02,090 - data.adapters - INFO - 跳过多链RNA: 1nyb
2025-05-12 19:42:02,100 - data.adapters - INFO - 跳过多链RNA: 1p6v
2025-05-12 19:42:02,101 - data.adapters - INFO - 跳过多链RNA: 1p6v
2025-05-12 19:42:02,147 - data.adapters - INFO - 跳过多链RNA: 1qzc
2025-05-12 19:42:02,179 - data.adapters - INFO - 跳过多链RNA: 1r2w
2025-05-12 19:42:02,196 - data.adapters - INFO - 跳过多链RNA: 1qzc
2025-05-12 19:42:02,382 - data.adapters - INFO - 跳过多链RNA: 1ry1
2025-05-12 19:42:02,440 - data.adapters - INFO - 跳过多链RNA: 1t4l
2025-05-12 19:42:02,546 - data.adapters - INFO - 跳过多链RNA: 1y1y
2025-05-12 19:42:02,650 - data.adapters - INFO - 跳过多链RNA: 1u63
2025-05-12 19:42:02,650 - data.adapters - INFO - 跳过多链RNA: 1zc8
2025-05-12 19:42:02,651 - data.adapters - INFO - 跳过多链RNA: 1zc8
2025-05-12 19:42:02,651 - data.adapters - INFO - 跳过多链RNA: 1zc8
2025-05-12 19:42:02,651 - data.adapters - INFO - 跳过多链RNA: 1zc8
2025-05-12 19:42:02,652 - data.adapters - INFO - 跳过多链RNA: 1zc8
2025-05-12 19:42:02,652 - data.adapters - INFO - 跳过多链RNA: 1zc8
2025-05-12 19:42:02,661 - data.adapters - INFO - 跳过多链RNA: 1x18
2025-05-12 19:42:02,661 - data.adapters - INFO - 跳过多链RNA: 1x18
2025-05-12 19:42:02,661 - data.adapters - INFO - 跳过多链RNA: 1x18
2025-05-12 19:42:02,682 - data.adapters - INFO - 跳过多链RNA: 1zn1
2025-05-12 19:42:02,705 - data.adapters - INFO - 跳过多链RNA: 1ysh
2025-05-12 19:42:02,705 - data.adapters - INFO - 跳过多链RNA: 1ysh
2025-05-12 19:42:02,705 - data.adapters - INFO - 跳过多链RNA: 1ysh
2025-05-12 19:42:02,719 - data.adapters - INFO - 跳过多链RNA: 2adt
2025-05-12 19:42:02,719 - data.adapters - INFO - 跳过多链RNA: 1wz2
2025-05-12 19:42:02,875 - data.adapters - INFO - 跳过多链RNA: 2d19
2025-05-12 19:42:02,876 - data.adapters - INFO - 跳过多链RNA: 2d1b
2025-05-12 19:42:02,894 - data.adapters - INFO - 跳过多链RNA: 2b6g
2025-05-12 19:42:02,895 - data.adapters - INFO - 跳过多链RNA: 2ese
2025-05-12 19:42:02,895 - data.adapters - INFO - 跳过多链RNA: 2f4x
2025-05-12 19:42:02,912 - data.adapters - INFO - 跳过多链RNA: 2bq5
2025-05-12 19:42:02,913 - data.adapters - INFO - 跳过多链RNA: 2bs0
2025-05-12 19:42:02,913 - data.adapters - INFO - 跳过多链RNA: 2bq5
2025-05-12 19:42:02,913 - data.adapters - INFO - 跳过多链RNA: 2bs0
2025-05-12 19:42:02,927 - data.adapters - INFO - 跳过多链RNA: 2b2e
2025-05-12 19:42:02,928 - data.adapters - INFO - 跳过多链RNA: 2b2e
2025-05-12 19:42:02,928 - data.adapters - INFO - 跳过多链RNA: 2go5
2025-05-12 19:42:02,928 - data.adapters - INFO - 跳过多链RNA: 2go5
2025-05-12 19:42:02,980 - data.adapters - INFO - 跳过多链RNA: 2ake
2025-05-12 19:42:02,981 - data.adapters - INFO - 跳过多链RNA: 2dr2
2025-05-12 19:42:02,981 - data.adapters - INFO - 跳过多链RNA: 2agn
2025-05-12 19:42:02,981 - data.adapters - INFO - 跳过多链RNA: 2agn
2025-05-12 19:42:02,981 - data.adapters - INFO - 跳过多链RNA: 2izn
2025-05-12 19:42:02,981 - data.adapters - INFO - 跳过多链RNA: 2iz8
2025-05-12 19:42:02,981 - data.adapters - INFO - 跳过多链RNA: 2iz8
2025-05-12 19:42:02,981 - data.adapters - INFO - 跳过多链RNA: 2hgh
2025-05-12 19:42:02,998 - data.adapters - INFO - 跳过多链RNA: 2der
2025-05-12 19:42:02,998 - data.adapters - INFO - 跳过多链RNA: 2det
2025-05-12 19:42:03,038 - data.adapters - INFO - 跳过多链RNA: 1zbh
2025-05-12 19:42:03,062 - data.adapters - INFO - 跳过多链RNA: 2iy3
2025-05-12 19:42:03,063 - data.adapters - INFO - 跳过多链RNA: 2j28
2025-05-12 19:42:03,063 - data.adapters - INFO - 跳过多链RNA: 2j37
2025-05-12 19:42:03,063 - data.adapters - INFO - 跳过多链RNA: 2j28
2025-05-12 19:42:03,063 - data.adapters - INFO - 跳过多链RNA: 2noq
2025-05-12 19:42:03,064 - data.adapters - INFO - 跳过多链RNA: 2noq
2025-05-12 19:42:03,064 - data.adapters - INFO - 跳过多链RNA: 2noq
2025-05-12 19:42:03,082 - data.adapters - INFO - 跳过多链RNA: 2ihx
2025-05-12 19:42:03,082 - data.adapters - INFO - 跳过多链RNA: 2ob7
2025-05-12 19:42:03,082 - data.adapters - INFO - 跳过多链RNA: 2fy1
2025-05-12 19:42:03,092 - data.adapters - INFO - 跳过多链RNA: 2il9
2025-05-12 19:42:03,093 - data.adapters - INFO - 跳过多链RNA: 2il9
2025-05-12 19:42:03,104 - data.adapters - INFO - 跳过多链RNA: 2du5
2025-05-12 19:42:03,104 - data.adapters - INFO - 跳过多链RNA: 2du4
2025-05-12 19:42:03,105 - data.adapters - INFO - 跳过多链RNA: 2du6
2025-05-12 19:42:03,149 - data.adapters - INFO - 跳过多链RNA: 2pcw
2025-05-12 19:42:03,149 - data.adapters - INFO - 跳过多链RNA: 2nr0
2025-05-12 19:42:03,149 - data.adapters - INFO - 跳过多链RNA: 2nr0
2025-05-12 19:42:03,150 - data.adapters - INFO - 跳过多链RNA: 2nr0
2025-05-12 19:42:03,150 - data.adapters - INFO - 跳过多链RNA: 2nr0
2025-05-12 19:42:03,154 - data.adapters - INFO - 跳过多链RNA: 2izm
2025-05-12 19:42:03,163 - data.adapters - INFO - 跳过多链RNA: 2jpp
2025-05-12 19:42:03,220 - data.adapters - INFO - 跳过多链RNA: 2om3
2025-05-12 19:42:03,221 - data.adapters - INFO - 跳过多链RNA: 2pn9
2025-05-12 19:42:03,232 - data.adapters - INFO - 跳过多链RNA: 2r93
2025-05-12 19:42:03,248 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-12 19:42:03,248 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-12 19:42:03,249 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-12 19:42:03,249 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-12 19:42:03,249 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-12 19:42:03,249 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-12 19:42:03,249 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-12 19:42:03,260 - data.adapters - INFO - 跳过多链RNA: 2r1g
2025-05-12 19:42:03,260 - data.adapters - INFO - 跳过多链RNA: 2r1g
2025-05-12 19:42:03,260 - data.adapters - INFO - 跳过多链RNA: 2r1g
2025-05-12 19:42:03,260 - data.adapters - INFO - 跳过多链RNA: 2r1g
2025-05-12 19:42:03,260 - data.adapters - INFO - 跳过多链RNA: 2r1g
2025-05-12 19:42:03,261 - data.adapters - INFO - 跳过多链RNA: 2r1g
2025-05-12 19:42:03,272 - data.adapters - INFO - 适配转换: 原始数据 285 项 -> 适配后 161 项
2025-05-12 19:42:03,272 - data.dataset - INFO - 适配处理成功: 161 个样本
2025-05-12 19:42:03,273 - data.dataset - INFO - 数据加载完成: 总计 161 个样本
2025-05-12 19:42:03,333 - data.dataset - ERROR - 保存缓存失败: cannot access local variable 'torch' where it is not associated with a value
2025-05-12 19:42:03,333 - data.dataset - INFO - 成功加载161个RNA样本
2025-05-12 19:42:03,333 - root - INFO - 创建数据加载器...
2025-05-12 19:42:03,334 - data.dataset - INFO - 数据集大小: 161
2025-05-12 19:42:03,334 - data.dataset - INFO - 数据集划分: 训练集=128, 验证集=16, 测试集=17
2025-05-12 19:42:03,335 - root - INFO - 创建扭转角预测模型...
2025-05-12 19:42:03,336 - models.torsion_predictor - INFO - 使用提供的RNA-FM模型
2025-05-12 19:42:03,336 - models.torsion_predictor - INFO - RNA-FM参数已冻结
2025-05-12 19:42:03,417 - root - INFO - 开始训练，共1个epoch
2025-05-12 19:43:00,037 - root - INFO - Epoch 1/1, Batch 10/16, Loss: 5.4615
2025-05-12 19:43:01,690 - root - INFO - Epoch 1/1 训练完成，耗时: 58.27秒, 平均损失: 5.6447
2025-05-12 19:43:59,027 - root - INFO - Epoch 1/1 验证完成，平均损失: 3.6362
2025-05-12 19:43:59,037 - models.torsion_predictor - INFO - 模型已保存到 output\20250512_194147\checkpoints\best_model.pth
2025-05-12 19:43:59,038 - root - INFO - 最佳模型已保存，验证损失: 3.6362
2025-05-12 19:43:59,038 - root - INFO - 训练完成
2025-05-12 19:43:59,038 - root - INFO - 加载最佳模型并在测试集上评估...
2025-05-12 19:43:59,048 - models.torsion_predictor - INFO - 从 output\20250512_194147\checkpoints\best_model.pth 加载了模型
2025-05-12 19:43:59,048 - models.torsion_predictor - INFO - 加载了扭转角类型: ['alpha', 'beta', 'gamma', 'delta', 'epsilon', 'zeta', 'chi', 'eta', 'theta', "eta'", "theta'", 'v0', 'v1', 'v2', 'v3', 'v4']
2025-05-12 19:43:59,049 - root - INFO - 测试结果将保存到: output\20250512_194147\test_results
2025-05-12 19:44:55,313 - utils.evaluation - INFO - alpha - MAE: 42.65185636632583, 循环相关性: 0.2879890852114734
2025-05-12 19:44:55,316 - utils.evaluation - INFO - beta - MAE: 22.53192772584803, 循环相关性: 0.39297080390593586
2025-05-12 19:44:55,319 - utils.evaluation - INFO - gamma - MAE: 31.99026876337388, 循环相关性: 0.31617894067483787
2025-05-12 19:44:55,323 - utils.evaluation - INFO - delta - MAE: 12.932778414557962, 循环相关性: 0.438509497572394
2025-05-12 19:44:55,326 - utils.evaluation - INFO - epsilon - MAE: 26.927799561444452, 循环相关性: 0.38658130168914795
2025-05-12 19:44:55,328 - utils.evaluation - INFO - zeta - MAE: 27.380790822646198, 循环相关性: 0.3559005768860088
2025-05-12 19:44:55,330 - utils.evaluation - INFO - chi - MAE: 25.471658370074103, 循环相关性: 0.39166879128007326
2025-05-12 19:44:55,331 - utils.evaluation - INFO - ==== 按组评估结果 ====
2025-05-12 19:44:55,331 - utils.evaluation - INFO - backbone 平均MAE: 27.40°
2025-05-12 19:44:55,331 - utils.evaluation - INFO - chi 平均MAE: 25.47°
2025-05-12 19:44:55,332 - utils.evaluation - INFO - 平均 MAE: 27.13°
2025-05-12 19:44:55,349 - root - INFO - 评估完成，指标:
2025-05-12 19:44:55,349 - root - INFO - alpha_mae: 42.6519
2025-05-12 19:44:55,350 - root - INFO - alpha_corr: 0.2880
2025-05-12 19:44:55,350 - root - INFO - beta_mae: 22.5319
2025-05-12 19:44:55,350 - root - INFO - beta_corr: 0.3930
2025-05-12 19:44:55,350 - root - INFO - gamma_mae: 31.9903
2025-05-12 19:44:55,350 - root - INFO - gamma_corr: 0.3162
2025-05-12 19:44:55,350 - root - INFO - delta_mae: 12.9328
2025-05-12 19:44:55,350 - root - INFO - delta_corr: 0.4385
2025-05-12 19:44:55,351 - root - INFO - epsilon_mae: 26.9278
2025-05-12 19:44:55,351 - root - INFO - epsilon_corr: 0.3866
2025-05-12 19:44:55,351 - root - INFO - zeta_mae: 27.3808
2025-05-12 19:44:55,351 - root - INFO - zeta_corr: 0.3559
2025-05-12 19:44:55,351 - root - INFO - chi_mae: 25.4717
2025-05-12 19:44:55,351 - root - INFO - chi_corr: 0.3917
2025-05-12 19:44:55,351 - root - INFO - backbone_avg_mae: 27.4026
2025-05-12 19:44:55,351 - root - INFO - backbone_avg_corr: 0.3630
2025-05-12 19:44:55,351 - root - INFO - chi_avg_mae: 25.4717
2025-05-12 19:44:55,351 - root - INFO - chi_avg_corr: 0.3917
2025-05-12 19:44:55,352 - root - INFO - avg_mae: 27.1267
