2025-05-12 20:24:00,631 - root - INFO - 配置: {'EXPERIMENT_DIR': 'output\\20250512_202351', 'OUTPUT_DIR': './output', 'DATA_DIR': './datasets', 'BATCH_SIZE': 8, 'NUM_EPOCHS': 4, 'LEARNING_RATE': 0.0001, 'DEVICE': 'cuda'}
2025-05-12 20:24:01,834 - root - INFO - 使用设备: cuda
2025-05-12 20:24:01,834 - root - INFO - 加载RNA-FM模型...
2025-05-12 20:24:03,750 - root - INFO - RNA-FM模型加载完成
2025-05-12 20:24:03,751 - root - INFO - 创建数据集，从目录: ./datasets
2025-05-12 20:24:03,752 - data.dataset - INFO - 找到1个pkl文件
2025-05-12 20:24:03,752 - data.dataset - INFO - 从缓存加载数据: ./output\cache\processed_data.pt
2025-05-12 20:24:03,931 - data.dataset - INFO - 从缓存加载了 161 个样本
2025-05-12 20:24:03,932 - data.dataset - INFO - 成功加载161个RNA样本
2025-05-12 20:24:03,932 - root - INFO - 创建数据加载器...
2025-05-12 20:24:03,933 - data.dataset - INFO - 数据集大小: 161
2025-05-12 20:24:03,933 - data.dataset - INFO - 数据集划分: 训练集=128, 验证集=16, 测试集=17
2025-05-12 20:24:03,934 - root - INFO - 创建扭转角预测模型...
2025-05-12 20:24:03,934 - models.torsion_predictor - INFO - 使用提供的RNA-FM模型
2025-05-12 20:24:03,935 - models.torsion_predictor - INFO - RNA-FM参数已冻结
2025-05-12 20:24:03,962 - root - INFO - 开始训练，共4个epoch
2025-05-12 20:24:58,475 - root - INFO - Epoch 1/4, Batch 10/16, Loss: 11.6348
2025-05-12 20:25:00,175 - root - INFO - Epoch 1/4 训练完成，耗时: 56.21秒, 平均损失: 12.3787
2025-05-12 20:25:54,854 - root - INFO - Epoch 1/4 验证完成，平均损失: 8.0265
2025-05-12 20:25:54,862 - models.torsion_predictor - INFO - 模型已保存到 output\20250512_202351\checkpoints\best_model.pth
2025-05-12 20:25:54,863 - root - INFO - 最佳模型已保存，验证损失: 8.0265
2025-05-12 20:26:48,862 - root - INFO - Epoch 2/4, Batch 10/16, Loss: 5.8330
2025-05-12 20:26:50,645 - root - INFO - Epoch 2/4 训练完成，耗时: 55.78秒, 平均损失: 6.1715
2025-05-12 20:27:45,207 - root - INFO - Epoch 2/4 验证完成，平均损失: 3.7210
2025-05-12 20:27:45,214 - models.torsion_predictor - INFO - 模型已保存到 output\20250512_202351\checkpoints\best_model.pth
2025-05-12 20:27:45,214 - root - INFO - 最佳模型已保存，验证损失: 3.7210
2025-05-12 20:28:40,685 - root - INFO - Epoch 3/4, Batch 10/16, Loss: 4.4741
2025-05-12 20:28:42,425 - root - INFO - Epoch 3/4 训练完成，耗时: 57.21秒, 平均损失: 4.5818
2025-05-12 20:29:37,918 - root - INFO - Epoch 3/4 验证完成，平均损失: 3.4601
2025-05-12 20:29:37,924 - models.torsion_predictor - INFO - 模型已保存到 output\20250512_202351\checkpoints\best_model.pth
2025-05-12 20:29:37,924 - root - INFO - 最佳模型已保存，验证损失: 3.4601
2025-05-12 20:30:32,750 - root - INFO - Epoch 4/4, Batch 10/16, Loss: 5.0033
2025-05-12 20:30:34,531 - root - INFO - Epoch 4/4 训练完成，耗时: 56.61秒, 平均损失: 4.4866
2025-05-12 20:31:29,348 - root - INFO - Epoch 4/4 验证完成，平均损失: 3.5069
2025-05-12 20:31:29,348 - root - INFO - 验证损失未改善，早停计数器: 1/10
2025-05-12 20:31:29,348 - root - INFO - 训练完成
2025-05-12 20:31:29,348 - root - INFO - 加载最佳模型并在测试集上评估...
2025-05-12 20:31:29,356 - models.torsion_predictor - INFO - 从 output\20250512_202351\checkpoints\best_model.pth 加载了模型
2025-05-12 20:31:29,356 - models.torsion_predictor - INFO - 加载了扭转角类型: ['alpha', 'beta', 'gamma', 'delta', 'epsilon', 'zeta', 'chi', 'eta', 'theta', "eta'", "theta'", 'v0', 'v1', 'v2', 'v3', 'v4']
2025-05-12 20:31:29,357 - root - INFO - 测试结果将保存到: output\20250512_202351\test_results
2025-05-12 20:32:24,777 - utils.evaluation - INFO - alpha - MAE: 35.0991590163287, 循环相关性: 0.30177391890217276
2025-05-12 20:32:24,779 - utils.evaluation - INFO - beta - MAE: 21.810632986180924, 循环相关性: 0.39548882842063904
2025-05-12 20:32:24,781 - utils.evaluation - INFO - gamma - MAE: 33.96109210743624, 循环相关性: 0.3256642117219813
2025-05-12 20:32:24,785 - utils.evaluation - INFO - delta - MAE: 11.789641127866858, 循环相关性: 0.4401429751340081
2025-05-12 20:32:24,788 - utils.evaluation - INFO - epsilon - MAE: 23.56482718972599, 循环相关性: 0.3916817763272454
2025-05-12 20:32:24,791 - utils.evaluation - INFO - zeta - MAE: 26.846395155962774, 循环相关性: 0.35755901301608367
2025-05-12 20:32:24,794 - utils.evaluation - INFO - chi - MAE: 18.027326303369858, 循环相关性: 0.41403887201757994
2025-05-12 20:32:24,796 - utils.evaluation - INFO - eta - MAE: 21.499166993533862, 循环相关性: 0.3886624241576475
2025-05-12 20:32:24,799 - utils.evaluation - INFO - theta - MAE: 29.976498435525333, 循环相关性: 0.34714444858186383
2025-05-12 20:32:24,802 - utils.evaluation - INFO - eta' - MAE: 20.167179893044864, 循环相关性: 0.3984060988706701
2025-05-12 20:32:24,805 - utils.evaluation - INFO - theta' - MAE: 28.498943104463464, 循环相关性: 0.3584495502359727
2025-05-12 20:32:24,808 - utils.evaluation - INFO - v0 - MAE: 9.439663887023926, 循环相关性: 0.45778344133320975
2025-05-12 20:32:24,812 - utils.evaluation - INFO - v1 - MAE: 14.29095885332893, 循环相关性: 0.43926530199892383
2025-05-12 20:32:24,816 - utils.evaluation - INFO - v2 - MAE: 14.786844337687773, 循环相关性: 0.4303534942514756
2025-05-12 20:32:24,819 - utils.evaluation - INFO - v3 - MAE: 14.878700536840102, 循环相关性: 0.44079489217085
2025-05-12 20:32:24,821 - utils.evaluation - INFO - v4 - MAE: 9.11994036506204, 循环相关性: 0.4595025269424214
2025-05-12 20:32:24,821 - utils.evaluation - INFO - ==== 按组评估结果 ====
2025-05-12 20:32:24,822 - utils.evaluation - INFO - backbone 平均MAE: 25.51°
2025-05-12 20:32:24,822 - utils.evaluation - INFO - chi 平均MAE: 18.03°
2025-05-12 20:32:24,822 - utils.evaluation - INFO - pseudo 平均MAE: 25.04°
2025-05-12 20:32:24,822 - utils.evaluation - INFO - ribose 平均MAE: 12.50°
2025-05-12 20:32:24,823 - utils.evaluation - INFO - 平均 MAE: 20.86°
2025-05-12 20:32:24,843 - root - INFO - 评估完成，指标:
2025-05-12 20:32:24,844 - root - INFO - alpha_mae: 35.0992
2025-05-12 20:32:24,844 - root - INFO - alpha_corr: 0.3018
2025-05-12 20:32:24,844 - root - INFO - beta_mae: 21.8106
2025-05-12 20:32:24,844 - root - INFO - beta_corr: 0.3955
2025-05-12 20:32:24,844 - root - INFO - gamma_mae: 33.9611
2025-05-12 20:32:24,844 - root - INFO - gamma_corr: 0.3257
2025-05-12 20:32:24,844 - root - INFO - delta_mae: 11.7896
2025-05-12 20:32:24,845 - root - INFO - delta_corr: 0.4401
2025-05-12 20:32:24,845 - root - INFO - epsilon_mae: 23.5648
2025-05-12 20:32:24,845 - root - INFO - epsilon_corr: 0.3917
2025-05-12 20:32:24,845 - root - INFO - zeta_mae: 26.8464
2025-05-12 20:32:24,845 - root - INFO - zeta_corr: 0.3576
2025-05-12 20:32:24,845 - root - INFO - chi_mae: 18.0273
2025-05-12 20:32:24,845 - root - INFO - chi_corr: 0.4140
2025-05-12 20:32:24,845 - root - INFO - eta_mae: 21.4992
2025-05-12 20:32:24,845 - root - INFO - eta_corr: 0.3887
2025-05-12 20:32:24,846 - root - INFO - theta_mae: 29.9765
2025-05-12 20:32:24,846 - root - INFO - theta_corr: 0.3471
2025-05-12 20:32:24,846 - root - INFO - eta'_mae: 20.1672
2025-05-12 20:32:24,846 - root - INFO - eta'_corr: 0.3984
2025-05-12 20:32:24,846 - root - INFO - theta'_mae: 28.4989
2025-05-12 20:32:24,846 - root - INFO - theta'_corr: 0.3584
2025-05-12 20:32:24,846 - root - INFO - v0_mae: 9.4397
2025-05-12 20:32:24,846 - root - INFO - v0_corr: 0.4578
2025-05-12 20:32:24,846 - root - INFO - v1_mae: 14.2910
2025-05-12 20:32:24,847 - root - INFO - v1_corr: 0.4393
2025-05-12 20:32:24,847 - root - INFO - v2_mae: 14.7868
2025-05-12 20:32:24,847 - root - INFO - v2_corr: 0.4304
2025-05-12 20:32:24,847 - root - INFO - v3_mae: 14.8787
2025-05-12 20:32:24,847 - root - INFO - v3_corr: 0.4408
2025-05-12 20:32:24,847 - root - INFO - v4_mae: 9.1199
2025-05-12 20:32:24,847 - root - INFO - v4_corr: 0.4595
2025-05-12 20:32:24,847 - root - INFO - backbone_avg_mae: 25.5120
2025-05-12 20:32:24,847 - root - INFO - backbone_avg_corr: 0.3687
2025-05-12 20:32:24,847 - root - INFO - chi_avg_mae: 18.0273
2025-05-12 20:32:24,847 - root - INFO - chi_avg_corr: 0.4140
2025-05-12 20:32:24,848 - root - INFO - pseudo_avg_mae: 25.0354
2025-05-12 20:32:24,848 - root - INFO - pseudo_avg_corr: 0.3732
2025-05-12 20:32:24,848 - root - INFO - ribose_avg_mae: 12.5032
2025-05-12 20:32:24,848 - root - INFO - ribose_avg_corr: 0.4455
2025-05-12 20:32:24,848 - root - INFO - avg_mae: 20.8598
